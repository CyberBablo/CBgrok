# README

## Описание проекта

Этот проект представляет собой систему для бэктестинга и оптимизации торговых стратегий на основе технических индикаторов, таких как скользящие средние (MA), индекс относительной силы (RSI) и средний истинный диапазон (ATR). Проект использует библиотеку **Optuna** для оптимизации гиперпараметров стратегии и позволяет сохранять лучшие модели для последующего использования.

### Основные особенности:
- Загрузка исторических данных с биржи (например, Binance) через библиотеку **CCXT**.
- Реализация торговой стратегии на основе скользящих средних с фильтрами тренда и RSI.
- Оптимизация параметров стратегии с использованием **Optuna**.
- Сохранение лучших параметров моделей и результатов бэктеста.
- Возможность запуска бэктеста для конкретной модели через отдельный модуль.

---

## Основные модули

Проект состоит из следующих ключевых модулей:

- **`exchange_adapter.py`**  
  Модуль для взаимодействия с биржей и загрузки OHLCV-данных (Open, High, Low, Close, Volume).

- **`indicators.py`**  
  Расчет технических индикаторов, таких как MA (скользящие средние), RSI, ATR и EMA (экспоненциальная скользящая средняя).

- **`strategy.py`**  
  Логика торговой стратегии: генерация сигналов покупки и продажи на основе индикаторов.

- **`backtest.py`**  
  Симуляция торговли и расчет метрик производительности, включая Sharpe Ratio, итоговый капитал и максимальную просадку.

- **`optimization.py`**  
  Оптимизация параметров стратегии с использованием **Optuna** и сохранение лучших моделей.

- **`utils.py`**  
  Вспомогательные функции, включая сохранение результатов в JSON-файлы.

- **`main.py`**  
  Основной скрипт для запуска оптимизации и бэктеста для нескольких валютных пар.

- **`run_model.py`**  
  Модуль для запуска бэктеста конкретной модели на основе сохраненных параметров.

---

## Алгоритм запуска бэктеста и поиска лучших моделей

1. **Запуск оптимизации**  
   - Используйте скрипт `main.py`, чтобы начать оптимизацию параметров стратегии для заданного списка валютных пар.  
   - **Optuna** ищет лучшие параметры, максимизируя Sharpe Ratio.  
   - Лучшие параметры для каждой валютной пары сохраняются в директорию `/library/best_models_params` в виде JSON-файлов. Имена файлов содержат хэш параметров и временную метку, например, `4a5b6c7d8e9f0a1b_20250316_183512.json`.

2. **Сохранение результатов**  
   - Во время оптимизации результаты каждого испытания сохраняются в директорию `order_bin`.  
   - Файлы именуются с префиксами `POS_` (прибыль) или `NEG_` (убыток), хэшем параметров и временной меткой, например, `POS_4a5b6c7d8e9f0a1b_20250316_184000.json`.  
   - Лучшие параметры сохраняются в `/library/best_models_params` для дальнейшего использования.

3. **Запуск бэктеста для лучших моделей**  
   - Используйте `run_model.py`, чтобы выполнить бэктест для конкретной модели. Укажите имя файла из `/library/best_models_params`.  
   - Модуль загружает параметры, данные для указанной валютной пары и проводит бэктест.  
   - Результаты сохраняются в `order_bin` с тем же хэшем параметров.

---

## Запуск модели с помощью `run_model.py`

Для запуска бэктеста конкретной модели выполните следующие шаги:

1. **Получите имя файла**  
   - После оптимизации в директории `/library/best_models_params` появятся JSON-файлы с именами вида `hash_timestamp.json` (например, `4a5b6c7d8e9f0a1b_20250316_183512.json`).

2. **Запустите `run_model.py`**  
   - В командной строке выполните команду:  
     ```bash
     python run_model.py <имя_файла> <начальный_капитал> <комиссия>
